[gd_scene load_steps=24 format=3 uid="uid://dftqgscgou0po"]

[ext_resource type="Texture2D" uid="uid://bmmhhij0uxb26" path="res://assets/background.png" id="1_5vw27"]
[ext_resource type="Script" uid="uid://xjqqwks4jnbg" path="res://scripts/spiders.gd" id="1_ig7tw"]
[ext_resource type="Texture2D" uid="uid://bqnn1m8fx08fe" path="res://assets/spider.png" id="2_0xm2m"]
[ext_resource type="PackedScene" uid="uid://lwbm555q4l6v" path="res://scene/npc.tscn" id="2_5vw27"]
[ext_resource type="PackedScene" uid="uid://dmo6ch2xreba2" path="res://living_room.tscn" id="2_kek77"]
[ext_resource type="PackedScene" uid="uid://dcv6rxbagi8t0" path="res://scene/destination.tscn" id="3_kek77"]
[ext_resource type="AudioStream" uid="uid://df7tkluxjl5au" path="res://assets/SFX/spider.ogg" id="4_kek77"]
[ext_resource type="AudioStream" uid="uid://bat8y31tjwrwr" path="res://assets/SFX/prototypejenaimarre.ogg" id="8_5vw27"]
[ext_resource type="Texture2D" uid="uid://ddtadj4ipd1r0" path="res://assets/arrow.png" id="8_kek77"]
[ext_resource type="FontFile" uid="uid://cuq8cid3txxts" path="res://assets/fonts/Unkempt-Regular.ttf" id="9_efxa6"]
[ext_resource type="Texture2D" uid="uid://b3do3tkjq1gda" path="res://assets/UI/A.png" id="10_dg77c"]
[ext_resource type="Texture2D" uid="uid://d1jfegrme7l14" path="res://assets/UI/E.png" id="10_ycdy4"]
[ext_resource type="Texture2D" uid="uid://25qjtlvyjm1k" path="res://assets/UI/mouse.png" id="12_w48qg"]
[ext_resource type="Script" uid="uid://le42puuhmucy" path="res://move_rooms.gd" id="13_vivmo"]
[ext_resource type="PackedScene" uid="uid://7j1od1qia3u1" path="res://kitchen_room.tscn" id="14_w48qg"]

[sub_resource type="SpriteFrames" id="SpriteFrames_5vw27"]

[sub_resource type="GDScript" id="GDScript_272bh"]
resource_name = "fear_bar"
script/source = "extends ProgressBar
func _ready() -> void:
	SignalBus.fear_changed.connect(fear_changed)

func fear_changed():
	self.value = Globals.fear
"

[sub_resource type="Theme" id="Theme_ycdy4"]
default_font = ExtResource("9_efxa6")
default_font_size = 32

[sub_resource type="GDScript" id="GDScript_5vw27"]
resource_name = "timer"
script/source = "extends Node2D

@onready var watch_hand = $WatchHand

func _ready():

	Globals.connect(\"timer_changed\", _on_timer_changed)

	update_watch_hand(Globals.time_remaining)

func _on_timer_changed(time_remaining):
	update_watch_hand(time_remaining)

func update_watch_hand(time_remaining):

	var progress = time_remaining / Globals.max_time
	var angle = progress * 360.0
	watch_hand.rotation_degrees = angle
"

[sub_resource type="Gradient" id="Gradient_5vw27"]
offsets = PackedFloat32Array(0.33333334, 0.34, 0.36)
colors = PackedColorArray(1, 1, 1, 1, 1, 1, 1, 0.61333334, 1, 1, 1, 0)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_kek77"]
gradient = SubResource("Gradient_5vw27")
width = 256
height = 256
fill = 1
fill_from = Vector2(0.46728972, 0.5)

[sub_resource type="Gradient" id="Gradient_4c57u"]
offsets = PackedFloat32Array(0.02, 1)
colors = PackedColorArray(1, 0, 0, 1, 1, 0, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_efxa6"]
gradient = SubResource("Gradient_4c57u")
width = 60
height = 4

[node name="Main" type="Node2D"]

[node name="NPC" type="Node" parent="."]

[node name="NPC" parent="NPC" node_paths=PackedStringArray("target") instance=ExtResource("2_5vw27")]
position = Vector2(-270, 75)
target = NodePath("../Destinations/Destination")

[node name="Destinations" type="Node" parent="NPC"]

[node name="Destination" parent="NPC/Destinations" node_paths=PackedStringArray("linked_destinations") instance=ExtResource("3_kek77")]
position = Vector2(-430, 161)
cause_stop = true
stop_duration = 2
linked_destinations = [NodePath("../Destination2"), NodePath("../Destination3"), NodePath("../Destination4")]
destination_orientation = Array[int]([3, 1, 1])

[node name="Destination2" parent="NPC/Destinations" node_paths=PackedStringArray("linked_destinations") instance=ExtResource("3_kek77")]
position = Vector2(-10, 392)
orientation = 3
linked_destinations = [NodePath("../Destination"), NodePath("../Destination3"), NodePath("../Destination4")]
destination_orientation = Array[int]([0, 0, 1])

[node name="Destination3" parent="NPC/Destinations" node_paths=PackedStringArray("linked_destinations") instance=ExtResource("3_kek77")]
position = Vector2(-120, -68)
orientation = 3
linked_destinations = [NodePath("../Destination2"), NodePath("../Destination"), NodePath("../Destination4")]
destination_orientation = Array[int]([3, 2, 3])

[node name="Destination4" parent="NPC/Destinations" node_paths=PackedStringArray("linked_destinations") instance=ExtResource("3_kek77")]
position = Vector2(361, 185)
orientation = 3
linked_destinations = [NodePath("../Destination2"), NodePath("../Destination"), NodePath("../Destination3")]
destination_orientation = Array[int]([2, 2, 0])

[node name="Camera" type="Camera2D" parent="."]

[node name="Background" type="Sprite2D" parent="Camera"]
z_index = -5
scale = Vector2(1.4762552, 1.476255)
texture = ExtResource("1_5vw27")

[node name="spiders" type="Node2D" parent="." node_paths=PackedStringArray("move_sound", "jump_sound")]
script = ExtResource("1_ig7tw")
spider_count = 5
base_spread = 200.0
spider_scale = 0.6999999999970896
spritesheet = ExtResource("2_0xm2m")
move_sound = NodePath("MovePlayer")
jump_sound = NodePath("JumpPlayer")

[node name="JumpPlayer" type="AudioStreamPlayer" parent="spiders"]

[node name="MovePlayer" type="AudioStreamPlayer" parent="spiders"]
stream = ExtResource("4_kek77")

[node name="MoveArea" type="Area2D" parent="spiders"]

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="spiders/MoveArea"]
polygon = PackedVector2Array(2, -190, 604, 160, -6, 515, -615, 163)

[node name="MoveArea2" type="Area2D" parent="spiders"]
position = Vector2(-1912, -5)

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="spiders/MoveArea2"]
polygon = PackedVector2Array(2, -190, 604, 160, -6, 515, -615, 163)

[node name="MoveArea3" type="Area2D" parent="spiders"]
position = Vector2(1920, -3)

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="spiders/MoveArea3"]
polygon = PackedVector2Array(616, 157, 353, 0, 250, 58, 0, -94, -85, -44, -174, -90, -611, 163, 5, 514)

[node name="Destination" parent="." instance=ExtResource("3_kek77")]

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
sprite_frames = SubResource("SpriteFrames_5vw27")

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="ProgressBar" type="ProgressBar" parent="CanvasLayer"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 1820.6666
offset_top = 107.0
offset_right = 747.6333
offset_bottom = -819.3334
grow_horizontal = 2
grow_vertical = 2
rotation = 1.5707964
script = SubResource("GDScript_272bh")

[node name="ButtonLeft" type="TextureButton" parent="CanvasLayer"]
offset_left = 494.0
offset_top = 767.0
offset_right = 706.0
offset_bottom = 925.0
texture_normal = ExtResource("8_kek77")

[node name="ButtonRight" type="TextureButton" parent="CanvasLayer"]
offset_left = 1259.0
offset_top = 767.0
offset_right = 1471.0
offset_bottom = 925.0
texture_normal = ExtResource("8_kek77")
flip_h = true

[node name="tutorial" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
theme = SubResource("Theme_ycdy4")

[node name="E" type="TextureRect" parent="CanvasLayer/tutorial"]
layout_mode = 0
offset_left = 117.0
offset_top = 257.0
offset_right = 214.45883
offset_bottom = 352.0
texture = ExtResource("10_ycdy4")
expand_mode = 3

[node name="Label2" type="Label" parent="CanvasLayer/tutorial"]
layout_mode = 0
offset_left = 71.0
offset_top = 352.0
offset_right = 265.0
offset_bottom = 391.0
text = "Emprise Faible"
horizontal_alignment = 1

[node name="A" type="TextureRect" parent="CanvasLayer/tutorial"]
layout_mode = 0
offset_left = 117.0
offset_top = 444.0
offset_right = 214.68867
offset_bottom = 539.0
texture = ExtResource("10_dg77c")
expand_mode = 3

[node name="Label" type="Label" parent="CanvasLayer/tutorial"]
layout_mode = 0
offset_left = 71.0
offset_top = 540.0
offset_right = 255.0
offset_bottom = 579.0
text = "Emprise Forte"
horizontal_alignment = 1

[node name="A2" type="TextureRect" parent="CanvasLayer/tutorial"]
layout_mode = 0
offset_left = 129.68867
offset_top = 629.2066
offset_right = 199.0
offset_bottom = 741.48035
texture = ExtResource("12_w48qg")
expand_mode = 5

[node name="Label3" type="Label" parent="CanvasLayer/tutorial"]
layout_mode = 0
offset_left = 78.0
offset_top = 739.0
offset_right = 244.0
offset_bottom = 778.0
text = "Deplacement"
horizontal_alignment = 1

[node name="Node2D" type="Node2D" parent="."]
position = Vector2(-736, -446)
script = SubResource("GDScript_5vw27")

[node name="Sprite2D2" type="Sprite2D" parent="Node2D"]
texture = SubResource("GradientTexture2D_kek77")

[node name="WatchHand" type="Sprite2D" parent="Node2D"]
texture = SubResource("GradientTexture2D_efxa6")
offset = Vector2(29, 0)

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="."]
stream = ExtResource("8_5vw27")
autoplay = true
parameters/looping = true

[node name="Rooms" type="Node2D" parent="."]
script = ExtResource("13_vivmo")

[node name="KitchenRoom" parent="Rooms" instance=ExtResource("14_w48qg")]
position = Vector2(1920, -6)

[node name="KitchenRoom2" parent="Rooms" instance=ExtResource("14_w48qg")]
position = Vector2(-1920, -6)

[node name="LivingRoom" parent="Rooms" instance=ExtResource("2_kek77")]

[connection signal="input_event" from="spiders/MoveArea" to="spiders" method="_on_move_area_input_event"]
[connection signal="input_event" from="spiders/MoveArea2" to="spiders" method="_on_move_area_input_event"]
[connection signal="input_event" from="spiders/MoveArea3" to="spiders" method="_on_move_area_input_event"]
[connection signal="pressed" from="CanvasLayer/ButtonLeft" to="Rooms" method="_on_button_left_pressed"]
[connection signal="pressed" from="CanvasLayer/ButtonRight" to="Rooms" method="_on_button_right_pressed"]
